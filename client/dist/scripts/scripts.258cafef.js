"use strict";angular.module("clientApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","chartjs"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl",controllerAs:"main"}).when("/stats",{templateUrl:"views/about.html",controller:"AboutCtrl",controllerAs:"about"}).otherwise({redirectTo:"/"})}]),angular.module("clientApp").controller("HeaderController",["$scope","$location",function(a,b){a.isActive=function(a){return a===b.path()}}]),angular.module("clientApp").controller("MainCtrl",["$scope","$http",function(a,b){a.host=location.host,a.longUrl="",a.custom="",a.btn="GO!",a.takeShort=function(){var c=b.post("/rest/go-shorty",{longUrl:a.longUrl,custom:a.custom});c.success(function(b){console.log("Inserted!"),a.rispostaJson=b,a.shortUrl="http://"+a.host+"/"+a.rispostaJson.shortUrl,a.err=""}),c.error(function(b){a.rispostaJson=b||"request failed",a.err=a.rispostaJson.err,a.shortUrl=""})}}]),angular.module("clientApp").controller("AboutCtrl",["$scope","$http",function(a,b){function c(a){r=[];var b=document.createElement("canvas");b.width="200",b.height="200",b.setAttribute("id","bStats");var c=document.getElementById("browser-chart-container");c.removeChild(c.firstChild),c.appendChild(b);var d=document.getElementById("browser-desc-container");f(d);for(var e in a){var h={value:a[e],color:g[e],highlight:"#FF5A5E",label:e};r.push(h);var l=document.createElement("span"),m=document.createTextNode(e);l.appendChild(m),l.setAttribute("class","label label-default"),l.setAttribute("style","padding: 5px; margin:2px; background-color:"+g[e]),d.appendChild(l)}i={segmentShowStroke:!0,segmentStrokeColor:"#f5f5f5",animateScale:!0},j=document.getElementById("bStats").getContext("2d"),k=new Chart(j).Pie(r,i)}function d(a){s=[];var b=document.createElement("canvas");b.width="200",b.height="200",b.setAttribute("id","cStats");var c=document.getElementById("country-chart-container");c.removeChild(c.firstChild),c.appendChild(b);var d=document.getElementById("country-desc-container");f(d);for(var e in a){var g="#"+Math.floor(16777215*Math.random()).toString(16);h.hasOwnProperty(e)&&(g=h[e]);var i={value:a[e],color:g,highlight:"#FF5A5E",label:e};s.push(i);var j=document.createElement("span"),k=document.createTextNode(e);j.appendChild(k),j.setAttribute("class","label"),j.setAttribute("style","padding: 5px; margin:2px; background-color:"+g),d.appendChild(j)}l={segmentShowStroke:!0,segmentStrokeColor:"#f5f5f5",animateScale:!0},m=document.getElementById("cStats").getContext("2d"),n=new Chart(m).Pie(s,l)}function e(a){t=[];var b=document.getElementById("date-chart-container"),c=document.createElement("canvas");c.width=parseFloat(window.getComputedStyle(b).width),c.height="300",c.setAttribute("id","dStats"),b.removeChild(b.firstChild),b.appendChild(c);var d=[],e=[];for(var f in a)d.push(f);d.sort();for(var g=0;g<d.length;g++)e.push(a[d[g]]);t={labels:d,datasets:[{label:"My First dataset",fillColor:"#FDD835",highlightFill:"#f0ad4e",data:e}]},p=document.getElementById("dStats").getContext("2d"),q=new Chart(p).Bar(t,o)}function f(a){for(;a.firstChild;)a.removeChild(a.firstChild)}a.shortUrl="",a.getStats=function(){var f=a.shortUrl;f=f.replace("http://"+location.host,"");var g=b.get("/rest/stats/"+f);g.success(function(b){console.log("lets stats!"),a.rispostaJson=b,c(b.browserStats),d(b.countryStats),e(b.dateStats),a.err=""}),g.error(function(b){a.rispostaJson=b||"request failed",a.err=a.rispostaJson.err,a.shortUrl=""})};var g={chrome:"#00796B",firefox:"#FDB45C",safari:"#00BCD4",explorer:"#01579B",opera:"#F7464A",other:"#607D8B"},h={IT:"#8BC34A",DE:"#37474F",US:"#B71C1C",JP:"#F44336",FR:"#3F51B5",GB:"#0D47A1",IN:"#FF9800",ES:"#FFEB3B",MX:"#4CAF50"};this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"];var i,j,k,l,m,n,o,p,q,r=[],s=[],t=[]}]),angular.module("clientApp").run(["$templateCache",function(a){a.put("views/about.html",'<!--<div class="jumbotron">\n  <h2>Statistic</h2>\n  <p class="lead">\n        <br>\n	    Insert the short url<input type="text" value="here" ng-model="shortUrl"> mai friend</p>\n	    <p><a class="btn btn-lg btn-success" ng-click="getStats()">Go!<span class="glyphicon glyphicon-ok">\n	   </span></a></p>\n	   <div ng-show="rispostaJson">\n		   <p>short: {{rispostaJson.numClicks}}</p>\n	  </div>\n</div>--> <div class="jumbotron"> <p class="h2" style="font-weight: bold; color: #B71C1C">Statistics</p> <p> <input type="text" ng-model="shortUrl" placeholder="Insert shortURL to get stats" class="form-control input-lg"> </p> <p> <a class="btn btn-lg btn-success" ng-click="getStats()">go <span class="glyphicon glyphicon-ok"></span> </a> </p> <p> <div ng-show="err" class="alert alert-danger">{{err}}</div> </p> </div> <div class="well h2" ng-show="rispostaJson.numClicks"> <p class="text-center" style="color:#37474F"> number of clicks: <b> {{rispostaJson.numClicks}}</b> </p> </div> <!--\n	<div id="chart-container" ng-show="rispostaJson">\n		<canvas id="browserStats" width="400" height="200"></canvas>\n	</div>\n\n<div class="well" id="country-chart-container">\n</div>\n	--> <div class="well"> <div class="container-fluid" style="padding:10px"> <p ng-show="rispostaJson.dateStats" class="text-center h2" style="color:#37474F">Clicks per month</p> <div id="date-chart-container"> </div> </div> </div> <div class="well"> <div class="container-fluid" style="padding:10px"> <div class="row text-center"> <div class="col-md-4 col-md-offset-1" style="padding:10px"> <div ng-show="rispostaJson.browserStats" class="row text-center"> <p class="text-center h2" style="color:#37474F">Browser chart</p> </div> <div class="row" id="browser-chart-container" style="width:auto"> </div> <div class="row" id="browser-desc-container" style="width:auto; padding:10px"> </div> </div> <div class="col-md-4 col-md-offset-2" style="padding:10px"> <div ng-show="rispostaJson.countryStats" class="row text-center"> <p class="text-center h2" style="color:#37474F">Country chart</p> </div> <div class="row" id="country-chart-container" style="width:auto"> </div> <div class="row" id="country-desc-container" style="width:auto; padding:10px"> </div> </div> </div> </div></div>'),a.put("views/main.html",'<!--<div class="row marketing">\n  <h1>Welcome to Go-shorty!</h1>\n            <form>\n            <p class="lead">Insert long url:<input type="text" ng-model="longUrl"></p>\n            <p>Insert custom url:<input type="text" ng-model="custom"></p> \n            <input type="button" value="GO!" ng-click="takeShort()">\n            </form>\n            <div ng-show="rispostaJson"><p>short: {{rispostaJson}}</p></div>\n</div>\n--> <p align="center"><a href="#/"><img src="images/logo.0249c5d7.png" class="img-responsive"></a></p> <div class="jumbotron"> <form role="form"> <div class="row marketing"> <div class="form-group"> <!--<p><h2>Welcome to Go-shorty!</h><br></p>--> <p> <input type="text" ng-model="longUrl" placeholder="Insert a long URL" class="form-control input-lg"> </p> <p> <input type="text" ng-model="custom" placeholder="Add custom text" class="form-control input-lg"> </p> <p> <a class="btn btn-lg btn-success" ng-href="#/" ng-click="takeShort()">go <span class="glyphicon glyphicon-ok"></span> </a> </p> <p> <div ng-show="shortUrl" class="alert alert-success">{{shortUrl}}</div> </p> <p> <div ng-show="err" class="alert alert-danger">{{err}}</div> </p> </div> </div> </form> </div>')}]);